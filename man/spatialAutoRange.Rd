% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatialAutoRange.R
\name{spatialAutoRange}
\alias{spatialAutoRange}
\title{Measure spatial autocorrelation in the predictor raster files}
\usage{
spatialAutoRange(rasterLayer, sampleNumber = 5000, border = NULL,
  doParallel = TRUE, nCores = NULL, showPlots = TRUE, degMetre = 111325,
  maxpixels = 1e+05, plotVariograms = FALSE, progress = TRUE)
}
\arguments{
\item{rasterLayer}{RasterLayer, RasterBrick or RasterStack of covariates to find spatial autocorrelation range.}

\item{sampleNumber}{Integer. The number of sample points of each raster layer to fit variogram models. It is 5000 by default,
however it can be increased by user to represent their region well (relevant to the extent and resolution of rasters).}

\item{border}{A SpatialPolygons* for clipping output blocks. This increases the computation time slightly.}

\item{doParallel}{Logical. Run in parallel when more than one raster layer is available. Given multiple CPU cores, it is
recommended to set it to \code{TRUE} when there is a large number of rasters to process.}

\item{nCores}{Integer. Number of CPU cores to run in parallel. If \code{nCores = NULL} half of available cores in your
machine will be used.}

\item{showPlots}{Logical. Show final plot of spatial blocks and autocorrelation ranges.}

\item{degMetre}{Integer. The conversion rate of metres to degree. This is for constructing spatial
blocks for visualisation. When the input map is in geographic coordinate system (decimal degrees), the block size is
calculated based on deviding the calculated \emph{range} by this value to convert to the input map's unit
(by default 111325; the standard distance of a degree in metres, on the Equator).}

\item{maxpixels}{Number of random pixels to select the blocks over the study area.}

\item{plotVariograms}{Logical. Plot fitted variograms. This can also be done after the analysis. Set to \code{FALSE} by default.}

\item{progress}{Logical. Shows progress bar. It works only when \code{doParallel = FALSE}.}
}
\value{
An object of class S3. A list object including:
    \itemize{
    \item{range - the suggested range, which is the median of all calculated ranges}
    \item{rangeTable - a table of input covariates names and their autocorrelation range}
    \item{plots - the output plot (the plot is shown by default)}
    \item{sampleNumber}
    \item{variograms - fitted variograms for all layers}
    }
}
\description{
This function provides a quantitative basis for choosing block size. The spatial autocorrelation in all continuous
predictor variables available as raster layers is assessed and reported. The function estimates spatial autocorrelation
ranges of all input raster layers. This is the range over which observations are independent and is determined by
constructing the empirical variogram, a fundamental geostatistical tool for measuring spatial autocorrelation.
The empirical variogram models the structure of spatial autocorrelation by measuring variability between all possible
pairs of points (O’Sullivan and Unwin, 2010). Results are plotted. See the details section for further information.
}
\details{
The input raster layers should be continuous for computing the variograms and estimating the range of spatial
autocorrelation. The input rasters should also have a specified coordinate reference system. However, if the reference
system is not specified, the function attempts to guess it based on the extent of the map. It assumes an unprojected
reference system for layers with extent lying between -180 and 180, and a projected reference system otherwise.

Variograms are calculated based on the distances between pairs of points, so unprojected rasters (in degrees) will
not give an accurate result (especially over large latitudinal extents). For unprojected rasters, the great circle
distance (rather than Euclidian distance) is used to calculate the spatial distances between pairs of points. To
enable more accurate estimate, it is recommended to transform unprojected maps (geographic coordinate
system / latitude-longitude) to a projected metric reference system (e.g. UTM, Lambert) where it is possible.
See \code{\link[automap]{autofitVariogram}} from \pkg{automap} and \code{\link[gstat]{variogram}} from \pkg{gstat} packages
for further information.
}
\examples{
\dontrun{

# load the example raster data
awt <- raster::brick(system.file("extdata", "awt.grd", package = "blockCV"))
# assign the names of the covariates
names(awt) <- c("bc01",  "bc04",  "bc05",  "bc06",  "bc12",  "bc15",  "bc17",  "bc20",  "bc33", "slope", "topo")

# run the model in parallel
range1 <- spatialAutoRange(rasterLayer = awt,
                           sampleNumber = 5000, # number of cells to be used
                           doParallel = TRUE,
                           nCores = NULL, # use half of the CPU cores
                           plotVariograms = FALSE,
                           showPlots = TRUE)

#' # run the model with no parallel
range2 <- spatialAutoRange(rasterLayer = awt,
                           sampleNumber = 5000,
                           doParallel = FALSE,
                           showPlots = TRUE,
                           progress = TRUE)

# show the result
summary(range1)
}
}
\references{
O’Sullivan, D., Unwin, D.J., 2010. Geographic Information Analysis, 2nd ed. John Wiley & Sons.

Roberts et al., 2017. Cross-validation strategies for data with temporal, spatial, hierarchical,
or phylogenetic structure. Ecography. 40: 913-929.
}
